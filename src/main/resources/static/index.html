<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>claWard News</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        .news-item { display: block; }
        .admin-section { display: none; }
        .card-img-top { height: 220px; object-fit: cover; }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="/">claWard</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/">News</a></li>
                <li class="nav-item"><a class="nav-link" href="/login.html">Login</a></li>
                <li class="nav-item"><a class="nav-link" href="/register.html">Register</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Page Content -->
<div class="container mt-4">
    <div class="row">
        <!-- News Column -->
        <div class="col-md-8">
            <h1 class="mb-4">Todayâ€™s Headlines</h1>

            <!-- Search -->
            <div class="input-group mb-3">
                <input type="text" id="searchInput" class="form-control" placeholder="Search articles..." />
            </div>

            <!-- News Articles -->
            <div id="newsList"></div>

        </div>

        <!-- Sidebar Widgets Column -->
        <div class="col-md-4">
            <div class="card my-4">
                <h5 class="card-header">ğŸ›¡ï¸ Security Bulletin</h5>
                <div class="card-body">
                    - ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 12ì ì´ìƒ, ëŒ€ë¬¸ì/ìˆ«ì/ê¸°í˜¸ í¬í•¨ì´ ê¶Œì¥ë©ë‹ˆë‹¤.<br><br>
                    - ë™ì¼í•œ ì•”í˜¸ë¥¼ ì—¬ëŸ¬ ì‚¬ì´íŠ¸ì—ì„œ ì¬ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.<br><br>
                    - ì´ë©”ì¼ ì²¨ë¶€íŒŒì¼ì€ í•­ìƒ ì¡°ì‹¬í•˜ì„¸ìš”.<br><br>
                    - ìµœì‹  ë³´ì•ˆ íŒ¨ì¹˜ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì ìš©í•˜ì„¸ìš”.<br><br>
                    - 2ì°¨ ì¸ì¦(MFA)ì„ ê¼­ í™œì„±í™”í•˜ì„¸ìš”.
                </div>
            </div>

            <div class="card my-4">
                <h5 class="card-header">About claWard</h5>
                <div class="card-body">
                    claWardëŠ” ì¼ìƒ ì† ë³´ì•ˆì„ íƒí—˜í•˜ëŠ” ë‰´ìŠ¤ í”Œë«í¼ì…ë‹ˆë‹¤.<br>
                    ê¸°ìˆ , ì‚¬íšŒ, ë¬¸í™” ë“± ë‹¤ì–‘í•œ ì´ì•¼ê¸°ë¥¼ ì „í•´ë“œë¦½ë‹ˆë‹¤.
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="py-5 bg-dark mt-5">
    <div class="container">
        <p class="m-0 text-center text-white">Copyright &copy; claWard News 2025</p>
    </div>
</footer>

<!-- Bootstrap + JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const token = localStorage.getItem('token');
    if (token) {
        try {
            const payload = JSON.parse(atob(token.split('.')[1]));
            if (payload.admin === true) {
                document.getElementById('adminSection').style.display = 'block';
            }
        } catch (e) {
            console.error("Invalid token format");
        }
    }

    const articles = [
        {
            title: "ë„ì‹¬ ì† ì•¼ê²½ ëª…ì†Œ 10ì„ ",
            content: "ì„œìš¸ì˜ ìˆ¨ê²¨ì§„ ì•¼ê²½ ëª…ì†Œë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ì—¬ë¦„ë°¤ ë°”ëŒ ë§ìœ¼ë©° í•œê°•ì„ ê±·ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ì¢‹ì€ì§€ ì•„ì‹œë‚˜ìš”? ì„œìš¸íƒ€ì›Œì—ì„œ ë‚´ë ¤ë‹¤ë³´ëŠ” ë„ì‹œì˜ ë¶ˆë¹›ì€ íŠ¹ë³„í•©ë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1011/800/400"
        },
        {
            title: "2025 ìµœì‹  ìŠ¤ë§ˆíŠ¸í° ë¹„êµ",
            content: "ì‚¼ì„±, ì• í”Œ, í™”ì›¨ì´ì˜ ì‹ ì œí’ˆë“¤ì„ ì „ê²© ë¹„êµí•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì¹´ë©”ë¼ ì„±ëŠ¥, ë°°í„°ë¦¬ ìˆ˜ëª…, ë¬´ê²Œê¹Œì§€ ì•Œì•„ë´…ë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1050/800/400"
        },
        {
            title: "ë¹„ê±´ ì‹ë‹¹ ì–´ë””ê¹Œì§€ ê°€ë´¤ë‹ˆ?",
            content: "ìš”ì¦˜ ëœ¨ëŠ” ë¹„ê±´ ë§›ì§‘ ë¦¬ìŠ¤íŠ¸! ì±„ì‹ì£¼ì˜ìë¿ ì•„ë‹ˆë¼ ì¼ë°˜ ê³ ê°ë„ ë§¤ë£Œëœ ë§›ì§‘ ì†Œê°œ.",
            img: "https://picsum.photos/id/292/800/400"
        },
        {
            title: "ì¸í„°ë„· ë°ˆì´ ë°”ê¾¼ ì •ì¹˜ í’í† ",
            content: "ì •ì¹˜ì™€ ìœ ë¨¸ì˜ ê²½ê³„ê°€ ë¬´ë„ˆì§€ê³  ìˆìŠµë‹ˆë‹¤. ë°ˆì´ ì—¬ë¡  í˜•ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€ ì ì  ì»¤ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1025/800/400"
        },
        {
            title: "AI ì‘ê³¡ ì‹œëŒ€ì˜ ì €ì‘ê¶Œ ë…¼ìŸ",
            content: "AIê°€ ë§Œë“  ìŒì•…ì€ ëˆ„êµ¬ì˜ ê²ƒì¸ê°€? ì‘ê³¡ê°€ í˜‘íšŒì™€ ê¸°ìˆ  ê¸°ì—…ì˜ ì…ì¥ì€ ì—‡ê°ˆë¦¬ê³  ìˆìŠµë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1037/800/400"
        },
        {
            title: "í•œêµ­ì¸ì˜ ì»¤í”¼ ì‚¬ë‘",
            content: "í•œêµ­ì¸ì˜ 1ì¼ í‰ê·  ì»¤í”¼ ì†Œë¹„ëŸ‰ì€ ì„¸ê³„ ìƒìœ„ê¶Œì…ë‹ˆë‹¤. ìŠ¤íƒ€íŠ¸ì—…ë“¤ë„ ì»¤í”¼ êµ¬ë… ì„œë¹„ìŠ¤ë¥¼ ì¶œì‹œí•˜ê³  ìˆì£ .",
            img: "https://picsum.photos/id/8/800/400"
        },
        {
            title: "ìš°ì£¼ íƒì‚¬ ê¸°ìˆ , ì–´ë””ê¹Œì§€ ì™”ë‚˜",
            content: "NASAì™€ SpaceXì˜ í˜‘ë ¥, ê·¸ë¦¬ê³  ìœ ëŸ½ ìš°ì£¼êµ­ì˜ ì°¨ì„¸ëŒ€ ë°œì‚¬ì²´ ê³„íšê¹Œì§€ ì´ì •ë¦¬í•©ë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1003/800/400"
        },
        {
            title: "2030ì„¸ëŒ€ì˜ ì£¼ê±° íŠ¸ë Œë“œ",
            content: "ì˜¤í”¼ìŠ¤í…” ëŒ€ì‹  ë„ì‹œí˜• ìƒí™œì£¼íƒì„ ì„ íƒí•˜ëŠ” ì²­ë…„ì¸µì´ ëŠ˜ê³  ìˆìŠµë‹ˆë‹¤.",
            img: "https://picsum.photos/id/1060/800/400"
        }
    ];

    function renderArticles(filter = "") {
        const container = document.getElementById("newsList");
        container.innerHTML = "";
        const filtered = articles.filter(a =>
            a.title.toLowerCase().includes(filter.toLowerCase())
        );
        filtered.forEach((article, index) => {
            const id = "collapse" + index;
            container.innerHTML += `
          <div class="card mb-4 news-item">
            <img src="${article.img}" class="card-img-top" alt="news image">
            <div class="card-body">
              <h2 class="card-title">${article.title}</h2>
              <p><a class="btn btn-outline-primary btn-sm" data-bs-toggle="collapse" href="#${id}" role="button" aria-expanded="false" aria-controls="${id}">ë” ì½ê¸°</a></p>
              <div class="collapse" id="${id}">
                <div class="card card-body">${article.content}</div>
              </div>
            </div>
            <div class="card-footer text-muted">Posted on July 15, 2025</div>
          </div>
        `;
        });
    }

    document.getElementById("searchInput").addEventListener("input", (e) => {
        renderArticles(e.target.value);
    });

    renderArticles();

    document.getElementById("downloadForm").addEventListener("submit", async function(e) {
        e.preventDefault();
        const filename = document.getElementById("filename").value;
        if (!filename) return;

        const response = await fetch(`/admin/download?file=${encodeURIComponent(filename)}`, {
            headers: { "Authorization": `Bearer ${token}` }
        });

        const status = document.getElementById("downloadStatus");
        if (response.ok) {
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            a.remove();
            status.textContent = "ë‹¤ìš´ë¡œë“œ ì™„ë£Œ";
        } else {
            status.textContent = "ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ (ê¶Œí•œ ë˜ëŠ” ê²½ë¡œ í™•ì¸)";
        }
    });
</script>
</body>
</html>
